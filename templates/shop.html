{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    {% include 'components/header.html' %}
    <title>Shop - Medofusion Surgical Supplies</title>
    <style>
        .section-header {
            text-align: center;
            margin-bottom: 50px;
        }
    </style>
</head>

<body>

    {% include 'components/navbar.html' %}

    <!-- Start Shop Area -->
    <div class="shop-area p-2">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title mb-0">Our <span style="color: #0cb8b6;">Products</span></h2>
                <p class="section-subtitle">Explore our comprehensive range of medical equipment and solutions</p>
            </div>
            <div class="row">

                <!-- Sidebar -->
                <div class="col-lg-3 mb-3">
                    <aside class="sidebar">
                        <!-- Categories Widget -->
                        <div class="sidebar-item category">
                            <div class="title" onclick="toggleCategories()" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                                <h4>Categories</h4>
                                <i class="fas fa-chevron-down d-lg-none" id="cat-chevron"></i>
                            </div>
                            <div class="sidebar-info" id="category-list">
                                <ul>
                                    <li><a href="{% url 'products' %}">All Products</a></li>
                                    {% for cat in categories %}
                                    <li><a href="{% url 'products' %}?category={{ cat.slug }}">{{ cat.name }} <span>({{ cat.product_count }})</span></a></li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                        
                        <script>
                            function toggleCategories() {
                                if (window.innerWidth < 992) {
                                    const list = document.getElementById('category-list');
                                    const chevron = document.getElementById('cat-chevron');
                                    
                                    if (list.style.display === 'block') {
                                        list.style.display = 'none';
                                        chevron.style.transform = 'rotate(0deg)';
                                    } else {
                                        list.style.display = 'block';
                                        chevron.style.transform = 'rotate(180deg)';
                                    }
                                }
                            }
                        </script>
                    </aside>
                </div>

                <!-- Products Grid -->
                <div class="col-lg-9">

                    <!-- Products -->
                    <div class="row">
                        {% if products %}
                            {% for product in products %}
                            <div class="col-6 col-md-4 col-lg-4 mb-4">
                                <div class="product-card">
                                    <div class="product-image">
                                        {% if product.image %}
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                        {% else %}
                                        <img src="https://placehold.co/600x600/f8f9fa/0cb8b6?text={{ product.name|truncatewords:2 }}" alt="{{ product.name }}">
                                        {% endif %}
                                        
                                        {% with second_image=product.images.first %}
                                            {% if second_image %}
                                                <img src="{{ second_image.image.url }}" class="img-hover" alt="{{ product.name }}">
                                            {% else %}
                                                <img src="{% static 'assets/images/product/prod1.jpg' %}" class="img-hover" alt="{{ product.name }}">
                                            {% endif %}
                                        {% endwith %}
                                        
                                        <!-- Optional: Add New/Featured badge logic here if needed -->
                                        <!-- <span class="product-badge">New</span> -->
                                    </div>
                                    <div class="product-info">
                                        <div class="product-category">{{ product.category.name }}</div>
                                        <h3 class="product-name">{{ product.name }}</h3>
                                        <div class="d-flex justify-content-between">
                                            <a href="{% url 'product-details' product.slug %}" class="btn-shop-action p-1"><i class="fas fa-eye me-1"></i> View</a>
                                            <a href="https://wa.me/1234567890?text=I'm interested in {{ product.name }}" class="btn-shop-action p-1"><i class="fab fa-whatsapp me-2"></i> Enquiry</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="col-12">
                                <div class="alert alert-info">No products found.</div>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Pagination (Commented out until backend implementation)
                    {% if is_paginated %}
                    <div class="row">
                        <div class="col-lg-12">
                            <nav class="pagination-area">
                                <ul class="pagination">
                                    <li class="page-item"><a class="page-link" href="#"><i class="fas fa-angle-left"></i></a></li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#"><i class="fas fa-angle-right"></i></a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                    {% endif %}
                    -->
                </div>
            </div>
        </div>
    </div>

    <!-- Start Featured Categories -->
    <div class="services-area default-padding bg-gray">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 offset-lg-2">
                    <div class="site-heading text-center">
                        <h2>Product <span>Categories</span></h2>
                        <p>
                            Browse our comprehensive range of medical equipment and surgical supplies
                        </p>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="text-center" style="background: white; padding: 30px; border-radius: 10px;">
                        <i class="flaticon-department" style="font-size: 48px; color: #0cb8b6; margin-bottom: 15px;"></i>
                        <h4>Modular OT Systems</h4>
                        <p>Complete operation theater solutions</p>
                        <a href="#" class="btn btn-theme btn-sm">View Products</a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="text-center" style="background: white; padding: 30px; border-radius: 10px;">
                        <i class="flaticon-medical" style="font-size: 48px; color: #0cb8b6; margin-bottom: 15px;"></i>
                        <h4>Hospital Furniture</h4>
                        <p>Beds, tables & medical furniture</p>
                        <a href="#" class="btn btn-theme btn-sm">View Products</a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="text-center" style="background: white; padding: 30px; border-radius: 10px;">
                        <i class="flaticon-anesthesia" style="font-size: 48px; color: #0cb8b6; margin-bottom: 15px;"></i>
                        <h4>Surgical Equipment</h4>
                        <p>Instruments & surgical supplies</p>
                        <a href="#" class="btn btn-theme btn-sm">View Products</a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="text-center" style="background: white; padding: 30px; border-radius: 10px;">
                        <i class="flaticon-lung-cancer" style="font-size: 48px; color: #0cb8b6; margin-bottom: 15px;"></i>
                        <h4>Medical Gas Systems</h4>
                        <p>Pipeline & distribution systems</p>
                        <a href="#" class="btn btn-theme btn-sm">View Products</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include 'components/footer.html' %}

</body>
</html>

<style>
/* Old product-item styles removed */
.shop-top-bar {
    background: #f8f9fa;
    padding: 15px 20px;
    border-radius: 5px;
    margin-bottom: 30px;
}
.sidebar {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
}
.sidebar-item .title h4 {
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 2px solid #108785;
}
.sidebar-item.category ul {
    list-style: none;
    padding: 0;
}
.sidebar-item.category ul li {
    padding: 8px 0;
    border-bottom: 1px solid #ddd;
}
.sidebar-item.category ul li a {
    color: #333;
    display: flex;
    justify-content: space-between;
}
.sidebar-item.category ul li a span {
    color: #999;
}

@media (max-width: 991px) {
    #category-list {
        display: none;
    }
    #cat-chevron {
        transition: transform 0.3s ease;
    }
}
</style>